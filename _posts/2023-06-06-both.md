---
title : DIVA and HESPEROS - new functionalities for a combined usage strategy
date : 2023-07-12 17:00:00 +0800
tags: []
---

<div align="justify">

A new workflow strategy has been designed to refine the accuracy and ease the process of manual annotation in AI applications. By combining DIVA and Hesperos, users gain the ability to perform accurate annotations while accessing detailed 3D visualisations, ensuring geometric constraints are considered throughout the annotation and correction process.

## **NEW FUNCTIONALITY OVERVIEW**
<hr class="title_style">

To take full advantage of virtual reality (VR) visualisation in DIVA and the precise pixel correction offered by the Hesperos plugin, both software platforms have introduced new features that include a system of oriented landmarks. These landmarks help identify areas that need correction or further distinction.


### Oriented landmarks in DIVA  
<hr class="subtitle_style">

In DIVA, the implementation of oriented landmarks includes the introduction of a new VR tool and a new desktop interface. This new version of DIVA is available at our [Github repository diva-hesperos](https://github.com/DecBayComp/diva-hesperos). Orientation data is essential since annotations are typically performed in a 2D environment (refer to the application examples sections).

<img align="center" src="/assets/videos/OrientedLandmarks_VR_tools.gif"/>

Within the VR mode, users can activate the **VR Oriented Landmarks** tool by choosing the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/4db44bce-3c7c-4643-89e2-fa66958334b2" width="20px" class="light"/> <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/3e7afa45-c70b-471e-93a9-6fde4ac08499" width="20px" class="dark"/> icon from a submenu under the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/93ba7823-3f89-4422-bd8d-a87675d07f13" width="20px" class="light"/> <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/67630e01-801b-4895-8968-aa77f7a242b1" width="20px" class="dark"/> icon in the **VR Menu**. This feature allows the addition of landmarks by pressing the <img src="https://github.com/DecBayComp/VoxelLearning/assets/49953723/35c93203-6e80-4a4e-849f-370bf26ba56d" width="15px" class="light"/> <img src="https://github.com/DecBayComp/VoxelLearning/assets/49953723/1d8f5852-b73f-434d-b7d7-cd10dc924cb7" width="15px" class="dark"/> button on the VR controller, which creates a sphere connected to a cylinder that shows orientation. The sphere's center aligns with the VR controller's position at the time of placement, and the controller's direction sets the landmark's orientation. To remove a landmark, align the controller until the landmark turns green, signifying it can be deleted with a press of the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/4928762e-5515-42c9-bd9b-d5410ffc1c39" width="20px" class="light"/> <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/4928762e-5515-42c9-bd9b-d5410ffc1c39" width="20px" class="dark"/> button.
> Using the **VR Oriented Landmarks** tool in sync with the **VR Clipper** tool is critical to capture the particular orientation needed to pinpoint anomalies, making navigation more efficient.
{: .prompt-tip}


Within the Desktop mode, each volume's specific menu appears in blue in the top right corner. The **Oriented Landmarks** interface is reachable via the **VR Annotations** panel by clicking the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/4db44bce-3c7c-4643-89e2-fa66958334b2" width="20px" class="light"/> <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/3e7afa45-c70b-471e-93a9-6fde4ac08499" width="20px" class="dark"/> button. This interface lists the oriented landmarks, displaying their ID and coordinates, and offers functionality to export this data. Users can export to a .csv file using the **Export** button or save as a .json file via the **Save** button for subsequent reopening in DIVA. The export file details the sphere’s center coordinates (x, y, z) and the orientations represented by Euler angles.


### Oriented landmarks in Hesperos 
<hr class="subtitle_style">




==================TOREREAD========================
In Hesperos, the implementation of oriented landmarks includes the introduction of a new panel : Panel 2.The orinted landmark in Hesperos are reprendresente by a white sphere and a yellowsegment for orientation save in two different new layers :     
    - the *`orientations`* layer which is a vector lyer containg the orientation segments
    - the *`landmarks`* layer which is a points layer containg the spheres.
Opacity of ech layrs can be control.

<img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/021357bd-4365-4cfe-a41e-e8aa757755fe" width="1000px"/>

When integrating landmarks created in VR into Hesperos, the sphere
and cylinder are represented by the sphere’s cross-section (as it is visualised
in 2D) and . Then, the user can navigate the
volume and the 2D viewto correct the anomaly. 

1. (not necessrayry) Importation can be done via the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/8ceb53d4-46e2-4480-a236-ccb591295f1b" width="150px"/> button.
    > Only .json files is supported, organised as {"_oriented_landmarks_parameters":{"_volume_positions":[{"x":255,"y":203,"z":152},{"x":299,"y":373,"z":152}],"_local_rotations":[{"x":0.0,"y":1.0,"z":0.0,"w":0.0},{"x":0.0,"y":1.0,"z":0.0,"w":0.0}]}}
    {: .prompt-warning }
Importation will automatically add landmark in the vlume and in the dor down menu list


2. To create an oriented lndmark:
    a. click on the <img src="https://user-images.githubusercontent.com/49953723/201736039-4ed10553-4a4b-4d5e-9d61-826dc139e437.png" width="25px"/> the curseur became a cross 
    b. click on the image at the corresponding localtion will create a landmark in the image (thus add a orizentations layers and landmarks layers)and close the tool
        >  the landmark sphere centre coordinates correspond to the mouse/pen’s position in the 2D slice, while the sphere radius is pre-defined based on the image size. The orientation data is derived from a singular orientation selected based on the 2D axes employed for visualisation.
        {: .prompt-info}
    c. the landmark ID will be diretly added to the drop-down menu (<img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/bc5db443-ba82-4cd7-92b8-f011947ec251" width="150px"/>) and the <img src="https://user-images.githubusercontent.com/49953723/201736152-319d8559-dbfc-4e52-aeb3-e8e34445f67a.png" width="25px"/> icon will be checked

3. To explore landmarks
    - click on the <img src="https://user-images.githubusercontent.com/49953723/201736152-319d8559-dbfc-4e52-aeb3-e8e34445f67a.png" width="25px"/> button to go to the slice index of the center of the selected landmark in the drop-down menu. The icon will be checked when the currently displayed slice index matches the slice index of the center of the selected landmark in the drop-down menu.
    - select one landmark in the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/bc5db443-ba82-4cd7-92b8-f011947ec251" width="150px"/> drop-down menu 


4. To remove one landmark
    a. Select one landark i nthe <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/bc5db443-ba82-4cd7-92b8-f011947ec251" width="150px"/> drop-down menu 
    b. click on <img src="https://user-images.githubusercontent.com/49953723/201736105-a9c45264-412a-453b-8475-5a9ab856b07d.png" width="25px"/> to remove the landmark from the volume and thus from the drop-down menu.

5. <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/18f240b0-bab8-40e5-89ea-8d7270dab743" width="150px"/> : to delete all andmark (in the volume and in the list)


6. To export landmarks as .json file use the <img src="https://github.com/DecBayComp/diva-hesperos/assets/49953723/c5ae6658-62f3-4b14-9bd0-cf38a80ad441" width="150px"/> button. 


> User can use the 3d vew fo hesperos to hlp to visualise quickly the potion 
{: .prompt-tip}



## **APPLICATION EXAMPLE : FROM DIVA TO HESPEROS**
<hr class="title_style">

To illustrate and explain this bi-directional system, the functionality
will be demonstrated in both directions: from Hesperos to DIVA and then from DIVA backto Hesperos. 



## **APPLICATION EXAMPLE : FROM HESPEROS TO DIVA**
<hr class="title_style">


blabla see hesperos post user manual for pixel tagging